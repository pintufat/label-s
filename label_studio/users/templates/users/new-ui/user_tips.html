{% load filters %}

<script nonce="{{request.csp_nonce}}">
  const dataTips = [
    {
      title: 'Fun Fact:',
      description: 'You can connect to major cloud storage platforms to retrieve new assets for labeling when they are uploaded, and deliver the annotations to improve and optimize models.',
      cta: {
        text: 'Learn more',
        url: `https://saod.in`,
        params: {
          experiment: 'login_revamp',
          treatment: 'sync_cloud_data',
        }
      },

    }, {
      title: 'You need to Know this.',
      description: 'Webhooks can be your automation trigger, kicking off model training or active learning as soon as you've hit your target number of annotations.',
      cta: {
        text: 'See use cases',
        url: 'https://saod.in',
        params: {
          experiment: 'login_revamp',
          treatment: 'enable_webhooks',
        }
      },

    }, {
      title: 'Intresting Fact',
      description: "Unlock the power of Label Studio Enterprise, featuring advanced tools and automation designed to accelerate data labeling while maintaining top-tier quality.",
      cta: {
        text: 'Learn more',
        url: 'https://saod.in',
        params: {
          experiment: 'login_revamp',
          treatment: 'enterprise_platform',
        }
      },

    }, {
      title: '?',
      description: 'SAOD has dozens of pre-built templates for all data types you can use to configure your labeling UI, from image classification to sentiment analysis to supervised LLM fine-tuning. ',
      cta: {
        text: 'See all templates',
        url: 'https://saod.in',
        params: {
          experiment: 'login_revamp',
          treatment: 'templates',
        }
      },
    }
  ];

  const SERVER_ID = {{ request.server_id|json_dumps_ensure_ascii|safe }};

  function createURL(url, params) {
    const base = new URL(url);

    Object.entries(params ?? {}).forEach(([key, value]) => {
      base.searchParams.set(key, value);
    });

    if (SERVER_ID) base.searchParams.set("server_id", SERVER_ID);

    return base.toString()
  }

  document.addEventListener('DOMContentLoaded', function() {
    const _title = document.querySelector('.tips .title');
    const _description = document.querySelector('.tips .description');

    const selectedTip = dataTips[Math.floor(Math.random() * dataTips.length)];
    const ctaUrl = createURL(selectedTip.cta.url, selectedTip.cta.params)

    _title.innerHTML = selectedTip.title;
    _description.innerHTML = `${selectedTip.description} <a href="${ctaUrl}" target="_blank">${selectedTip.cta.text}</a>`;
  });
</script>

<div class="tips">
  <div class="title"></div>
  <div class="description"></div>
</div>
